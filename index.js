const Telegraf = require('telegraf')
const Markup = require('telegraf/markup')

const bot = new Telegraf(process.env.BOT_TOKEN)

const about = `
  <b>Ð¡ÐœÐ«Ð¡Ð›</b> â€“ Friends-cafe Ð² ÐÐ¸Ð¶Ð½ÐµÐ¼ ÐÐ¾Ð²Ð³Ð¾Ñ€Ð¾Ð´Ðµ!

  "Friends-cafe" - ÑÑ‚Ð¾ Ð¾ÑÐ¾Ð±Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚, Ð²Ñ‹ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚Ðµ Ð² Ð¼ÐµÑÑ‚Ð¾, Ð³Ð´Ðµ Ñ Ð²Ð°Ð¼Ð¸ Ð¾Ð±Ñ‰Ð°ÑŽÑ‚ÑÑ. Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÑƒÑŽÑ‚ÑÑ Ñ‚ÐµÐ¼, Ñ‡Ñ‚Ð¾ Ñƒ Ð²Ð°Ñ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð² Ð¶Ð¸Ð·Ð½Ð¸. Ð Ñ‚Ð°Ðº Ð¶Ðµ ÐºÐ°Ðº Ð¸ Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð¸Ð¹ Ð´Ñ€ÑƒÐ³, Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ð¾Ð¼Ð¾Ð»Ñ‡Ð°Ñ‚ÑŒ Ð¸ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð²Ð°ÑˆÐµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ.. Ð¸Ð»Ð¸ Ð¿Ð¾Ð´Ð½ÑÑ‚ÑŒ ÐµÐ³Ð¾, ÐµÑÐ»Ð¸ Ð²Ñ‹ Ð½Ðµ Ð² Ð´ÑƒÑ…Ðµ ))

  Ðš Ð½Ð°Ð¼ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð°Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ð¸ Ð¿ÐµÑ€ÐµÐºÑƒÑÐ¸Ñ‚ÑŒ Ð²ÐºÑƒÑÐ½ÐµÐ¹ÑˆÐ¸Ð¼Ð¸ ÑÑÐ½Ð´Ð²Ð¸Ñ‡Ð°Ð¼Ð¸, Ð¸ Ð²Ñ‹Ð¿Ð¸Ñ‚ÑŒ Ð±Ð¾Ð´Ñ€ÑÑ‰ÐµÐ³Ð¾ ÐºÐ¾Ñ„Ðµ.
  Ð’Ð°Ñ Ð¾Ð±Ñ€Ð°Ð´ÑƒÐµÑ‚ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð°Ñ Ñ†ÐµÐ½Ð° Ð¸ Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐµ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾.

  Ðš Ð²Ð°ÑˆÐµÐ¼Ñƒ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸ÑŽ:
  - ÐšÐ¾Ñ„Ðµ;
  - Ð¡ÑÐ½Ð´Ð²Ð¸Ñ‡Ð¸;
  - ÐšÐ¾Ð¼Ð±Ð¾ ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ (ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ Ð´Ð»Ñ cÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð¾Ð²);
  - ÑÐµÐ·Ð¾Ð½Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ.

  ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½ Ðº Ð¿Ð¾ÑÐµÑ‰ÐµÐ½Ð¸ÑŽ! Ð–Ð´Ñ‘Ð¼ Ð² Ð³Ð¾ÑÑ‚Ð¸!
`;

bot.command('start', ({ reply }) =>
  reply('ÐŸÑ€Ð¸Ð²ÐµÑ‚!', Markup.keyboard([
      [Markup.callbackButton('ÐœÐµÐ½ÑŽ', 'ÐœÐµÐ½ÑŽ'), Markup.callbackButton('Ðž Ð½Ð°Ñ', 'Ðž Ð½Ð°Ñ')],
      [Markup.callbackButton('Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹', 'Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹'), Markup.callbackButton('ÐÐ´Ñ€ÐµÑ', 'ÐÐ´Ñ€ÐµÑ')]
    ])
    .resize()
    .extra()
  )
)

const getMenu = (ctx) => ctx.replyWithPhoto('https://pp.userapi.com/c636929/v636929456/5f3ba/7QI_b7wbSOE.jpg');
const getAddress = (ctx) => ctx.replyWithLocation(56.300535, 43.9835956).then(ctx.reply('ÐÐ¸Ð¶Ð½Ð¸Ð¹ ÐÐ¾Ð²Ð³Ð¾Ñ€Ð¾Ð´, Ð¿Ñ€Ð¾ÑÐ¿ÐµÐºÑ‚ Ð“Ð°Ð³Ð°Ñ€Ð¸Ð½Ð° 21'));
const getMode = (ctx) => ctx.reply(`
  Ð¿Ð½-ÑÐ±: 09:00 - 21:00
  Ð²Ñ: 11:00 - 21:00
`);

/* ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ */
bot.command('help', (ctx) => ctx.reply(
`
  Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°Ð¼Ð¸:

  /menu -  Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð¼ÐµÐ½ÑŽ
  /mode - Ñ€ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹
  /address - Ð°Ð´Ñ€ÐµÑ
`
));
bot.command('/menu', (ctx) => { getMenu(ctx) });
bot.command('/mode', (ctx) => getMode(ctx));
bot.command('/address', (ctx) => getAddress(ctx));

/* Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ */
bot.hears('ÐœÐµÐ½ÑŽ', (ctx) => { getMenu(ctx) });
bot.hears('Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹', (ctx) => getMode(ctx));
bot.hears('ÐÐ´Ñ€ÐµÑ', (ctx) => getAddress(ctx));
bot.hears('Ðž Ð½Ð°Ñ', (ctx) => (ctx.replyWithHTML(about)));

bot.hears(/Ð¿Ð¾ÐºÐ°/i, (ctx) => ctx.reply('Ð”Ð¾ Ð½Ð¾Ð²Ñ‹Ñ… Ð²ÑÑ‚Ñ€ÐµÑ‡!'));

/* Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ */
bot.on('sticker', (ctx) => ctx.reply('ðŸ‘'));

bot.catch((err) => {
  console.log('Ooops', err);
})

bot.startPolling();
